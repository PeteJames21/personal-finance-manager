{% extends "forms.html" %}
{% block content %}
<div class="container mt-4">
    <form method="POST" action="{{ url_for('add_transaction') }}" class="needs-validation" novalidate>
        {{ form.csrf_token }}
     
        <div class="form-group">
            {{ form.category.label }}
            {{ form.category(class="form-control", required="required") }}
        </div>
        <div class="form-group">
            {{ form.amount.label }}
            {{ form.amount(class="form-control", required="required") }}
        </div>
        <div class="form-group" id="account_debited_field">
            {{ form.account_debited.label }}
            {{ form.account_debited(class="form-control") }}
        </div>
        <div class="form-group" id="account_credited_field">
            {{ form.account_credited.label }}
            {{ form.account_credited(class="form-control") }}
        </div>
        <div class="form-group" id="subcategory">
            {{ form.subcategory.label }}
            {{ form.subcategory(class="form-control") }}
        </div>
        <div class="form-group">
            {{ form.date.label }}
            {{ form.date(class="form-control", required="required") }}
        </div> 
        <div class="form-group">
            {{ form.submit(class="btn btn-primary") }}
        </div>
    </form>
</div>

<!-- jQuery and Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
<script>
    $(document).ready(function () {
        function toggleAccountFields() {
            var selectedCategory = $("#category option:selected").val();
            if (selectedCategory === 'incomes') {
                $("#account_credited_field").hide();
                $("#account_debited_field").show();
                $("#subcategory").show();
            } else if (selectedCategory === 'expenses') {
                $("#account_debited_field").hide();
                $("#account_credited_field").show();
                $("#subcategory").show();
            } else if (selectedCategory === 'transfers') {
                $("#account_debited_field").show();
                $("#account_credited_field").show();
                $("#subcategory").hide();
                
            }
        }

        // Initial setup
        toggleAccountFields();

        // Bind change event to the category dropdown
        $("#category").change(function () {
            toggleAccountFields();
        });
    });
</script>
{% endblock %}