<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Link to the Bootstrap CSS file -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- Link to the external CSS file -->
    <link rel="stylesheet" type="text/css" href="../static/styles/base.css">
    <link rel="stylesheet" type="text/css" href="../static/styles/summary.css">
    <link rel="stylesheet" type="text/css" href="../static/styles/income.css">

    <title>Your Web Page</title>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light">
    <div class="navbar-brand">
        <p>Logo </p>
        <p>Current User: {{ current_user.username }}</p>
        <p>Current Profile: {{ data['profile'] }}</p>
    </div>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
        <div class="navbar-nav">
            <a class="nav-item nav-link" href="{{ url_for('home') }}">Home</a>

            <a class="nav-item nav-link" href="{{ url_for('income') }}">Income</a>
            <a class="nav-item nav-link" href="{{ url_for('expense') }}">Expense</a>
            <a class="nav-item nav-link" href="#Transfers">Transfers</a>
            <a class="nav-item nav-link" href="#Balances">Balances</a>
            <a class="nav-item nav-link" href="{{ url_for('logout') }}">Sign Out</a>
        </div>
    </div>
</nav>


<!-- Content Section -->
<div class="container mt-4">
    <!-- Flash messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="alert-container">
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}" role="alert">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <!-- Block Content (for Flask content insertion) -->
    {% block content %}{% endblock %}
</div>

<!-- Bootstrap JS (assuming you're using Bootstrap for styling) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>
    document.getElementById('toggleDateFilter').addEventListener('click', function() {
        var dateOptions = document.querySelector('.date-options');
        dateOptions.style.display = (dateOptions.style.display === 'none') ? 'block' : 'none';
    });
</script>
<script>
    // JavaScript to dynamically create options in the dropdown
    var profiles = {{ profiles | tojson | safe }};  // Access Jinja2 variable

    function toggleDropdown() {
        var dropdown = document.getElementById("profileDropdown");

        // Clear existing options
        dropdown.innerHTML = "";

        // Populate options from profiles list
        profiles.forEach(function (profile) {
            var option = document.createElement("a");
            option.textContent = profile;
            option.href = "#";  // Set the appropriate href
            option.onclick = function () {
                switchProfile(profile);
                toggleDropdown();  // Hide dropdown after selection
            };
            dropdown.appendChild(option);
        });

        // Show/hide dropdown
        dropdown.style.display = (dropdown.style.display === 'none') ? 'block' : 'none';
    }

    function switchProfile(selectedProfile) {
        // Perform any additional actions when a profile is selected
        // For example, you can send the selectedProfile to /home
        window.location.href = "/home?selectedProfile=" + selectedProfile;
    }

    // Close the dropdown if the user clicks outside of it
    window.onclick = function (event) {
        if (!event.target.matches('.dropbtn')) {
            var dropdowns = document.getElementsByClassName("dropdown-content");
            for (var i = 0; i < dropdowns.length; i++) {
                var openDropdown = dropdowns[i];
                if (openDropdown.style.display === 'block') {
                    openDropdown.style.display = 'none';
                }
            }
        }
    }
</script>
</script>
</body>
</html>
